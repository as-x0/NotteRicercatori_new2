<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>FAOSTAT Game - Player</title>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <h1>Player</h1>
  <label>Nome: <input type="text" id="playerName"></label><br>
  <label>Room ID: <input type="text" id="roomId"></label><br>
  <button id="joinRoom">Entra</button>

  <div id="gameArea" style="display:none;">
    <h3>Scegli un paese</h3>
    <select id="countrySelect"></select>
    <button id="chooseCountry">Scegli</button>
  </div>

  <script>
    const socket = io();
    const playerName = document.getElementById("playerName");
    const roomIdInput = document.getElementById("roomId");
    const joinBtn = document.getElementById("joinRoom");
    const gameArea = document.getElementById("gameArea");
    const countrySelect = document.getElementById("countrySelect");
    const chooseBtn = document.getElementById("chooseCountry");

    let currentRoomId = null;

    joinBtn.onclick = () => {
      const name = playerName.value.trim();
      const roomId = roomIdInput.value.trim();
      if (!name || !roomId) return alert("Inserisci nome e Room ID!");
      currentRoomId = roomId;
      socket.emit("joinRoom", { roomId, name });
    };

    chooseBtn.onclick = () => {
      const country = countrySelect.value;
      if (!country) return alert("Seleziona un paese!");
      socket.emit("selectCountry", { roomId: currentRoomId, country });
    };

    socket.on("gameStarted", () => {
      gameArea.style.display = "block";
    });

    socket.on("countriesList", (countries) => {
      countrySelect.innerHTML = countries.map(c => `<option>${c}</option>`).join("");
    });
  </script>
</body>
</html>
